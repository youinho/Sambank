<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.mapper.AdminMapper">


	<!-- cno로 고객정보 -->
	<select id="select_by_cno" resultType="com.spring.domain.CustomerVO">
		select * from customertbl
		where cno=#{cno}
	</select>


	<!-- search (name, birth, mobile) -->
	<select id="search_customer" resultType="com.spring.domain.CustomerVO">
	<![CDATA[
		select /*+INDEX_DESC(customertbl customertbl_index)*/
		 cno, name, birth, mobile, address 
		from customertbl
		where cno > 0 and name like '%'||#{name}||'%' and birth like '%'||#{birth}||'%' and mobile like '%'||#{mobile}||'%' and rownum < 100
		order by cno desc
	]]>
	</select>


	<!-- ano 있나없나 deposittbl exists 조회 -->
	<select id="exists_deposit_ano" resultType="int">
		select count(ano) from deposittbl
		where ano=#{ano}
	</select>

	<!-- id 아이디 중복 체크 -->
	<select id="checkId" resultType="int">
		select count(*) from customertbl
		where id=#{id}
	</select>


	<!-- 계정 확인 -->
	<select id="selectOne" resultType="com.spring.domain.AdminVO">
		select * from admintbl
		where id=#{id} and password=#{password}
	</select>

	<!-- 테이블 생성 -->
	<select id="register_account">
		create table ACC_${num}(bal1 number(20), bal2 number(10), bal3 number(22))
	</select>

	<!-- 등록 -->
	<insert id="insert_account">
		insert into savings_accounttbl(sno, cno, ano, balance) values(#{sno}, #{cno}, #{ano}, 0) 
	</insert>


	<insert id="register_customer">
		insert into customertbl(cno, rating, name, gender, birth, resident_registration_no, address, mobile, id, password, passhint, email, withdrawal_limits, check_card) 
		values(seq_customer.nextVal, #{rating}, #{name}, #{gender}, #{birth}, #{resident_registration_no},#{address}, #{mobile}, #{id}, #{password}, #{passhint}, #{email}, #{withdrawal_limits}, #{check_card}) 
	
	</insert>


	<insert id="create_deposit">
		insert into deposittbl(dno, cno, ano, balance) values(seq_deposit.nextVal, #{cno}, #{ano}, 0)
	</insert>
	
	
	<select id="get_deposit_list" resultType="com.spring.domain.DepositVO">
		select * from deposittbl where dno > 0 order by dno desc
		
		
	</select>
	
	
	
	
	

	<insert id="test1">
		insert into test1 values(#{value})
	</insert>
	<insert id="test2">
		insert into test2 values(#{value})
	</insert>

</mapper>